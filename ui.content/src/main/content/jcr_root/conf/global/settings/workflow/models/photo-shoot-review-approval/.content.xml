<?xml version="1.0" encoding="UTF-8"?>
<jcr:root xmlns:sling="http://sling.apache.org/jcr/sling/1.0" xmlns:cq="http://www.day.com/jcr/cq/1.0" xmlns:jcr="http://www.jcp.org/jcr/1.0" xmlns:nt="http://www.jcp.org/jcr/nt/1.0"
    jcr:primaryType="cq:Page">
    <jcr:content
        cq:designPath="/libs/settings/wcm/designs/default"
        cq:lastModified="{Date}2018-10-23T16:20:15.348-04:00"
        cq:lastModifiedBy="retoucher"
        cq:template="/libs/cq/workflow/templates/model"
        jcr:description="Workflow to get approvals from Approvers by Photographers"
        jcr:primaryType="cq:PageContent"
        jcr:title="Photo Approval"
        sling:resourceType="cq/workflow/components/pages/model"
        multiResourceSupport="true"
        workflowStages="[Photo Approval,Retouch Approval,Approvals Complete]">
        <flow
            jcr:primaryType="nt:unstructured"
            sling:resourceType="foundation/components/parsys">
            <taskworkflowstep
                jcr:created="{Date}2018-10-11T18:22:27.331-04:00"
                jcr:createdBy="admin"
                jcr:description="The task assigned to Approvers to Review Photos"
                jcr:lastModified="{Date}2018-10-23T15:26:38.809-04:00"
                jcr:lastModifiedBy="admin"
                jcr:primaryType="nt:unstructured"
                jcr:title="Photo Review"
                sling:resourceType="cq/projects/taskworkflowstep">
                <metaData
                    jcr:primaryType="nt:unstructured"
                    argActions="[Request for Changes,Send for clip and crop,Approve and Move to Final,Terminate the Request]"
                    argTaskDescription="Please review the photographs and provide approval or request for changes. Make a note to tag all the approved assets appropriately "
                    argTaskName="Photo Review and Tag Assets"
                    argTaskPriority="Medium"
                    PROCESS="com.adobe.cq.projects.impl.workflow.ProjectTaskWorkflowProcess"
                    PROCESS_AUTO_ADVANCE="false"
                    PROCESS_PERSIST_ANONYMOUS_WORKITEM="true"
                    script="var projectApprovalGrp = workflowData.getMetaDataMap().get(&quot;project.group.approver&quot;,&quot;administrators&quot;);&#xd;&#xa;task.setCurrentAssignee(projectApprovalGrp);&#xd;&#xa;task.setProperty(&quot;taskTypeName&quot;,&quot;dam:review&quot;);"
                    sendEmailNotification="true"
                    workflowStage="Photo Approval"/>
            </taskworkflowstep>
            <or
                jcr:created="{Date}2018-10-11T18:35:52.410-04:00"
                jcr:createdBy="admin"
                jcr:lastModified="{Date}2018-10-23T15:26:14.310-04:00"
                jcr:lastModifiedBy="admin"
                jcr:primaryType="nt:unstructured"
                jcr:title="Approver Actions on Photo Review Task"
                sling:resourceType="cq/workflow/components/model/or"
                branches="4"
                orSplit="true"
                script1="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Approve and Move to Final&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}"
                script2="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Request for Changes&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}"
                script3="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Send for clip and crop&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}"
                script4="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Terminate the Request&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}">
                <_x0031_
                    jcr:primaryType="nt:unstructured"
                    sling:resourceType="cq/flow/components/parsys">
                    <process
                        jcr:created="{Date}2018-10-11T18:50:32.378-04:00"
                        jcr:createdBy="admin"
                        jcr:lastModified="{Date}2018-10-12T14:53:14.969-04:00"
                        jcr:lastModifiedBy="admin"
                        jcr:primaryType="nt:unstructured"
                        jcr:title="Auto Move Approved Assets"
                        sling:resourceType="cq/workflow/components/model/process">
                        <metaData
                            jcr:primaryType="nt:unstructured"
                            PROCESS="com.adobe.summit23.l717.AEMaaCS Transition.AutoMoveApprovedPhotoAssets"
                            PROCESS_AUTO_ADVANCE="true"
                            workflowStage="Approvals Complete"/>
                    </process>
                </_x0031_>
                <_x0032_
                    jcr:primaryType="nt:unstructured"
                    sling:resourceType="cq/flow/components/parsys">
                    <taskworkflowstep
                        jcr:created="{Date}2018-10-11T18:41:30.636-04:00"
                        jcr:createdBy="admin"
                        jcr:lastModified="{Date}2018-10-12T12:09:19.031-04:00"
                        jcr:lastModifiedBy="admin"
                        jcr:primaryType="nt:unstructured"
                        jcr:title="Approver Requested Changes"
                        sling:resourceType="cq/projects/taskworkflowstep">
                        <metaData
                            jcr:primaryType="nt:unstructured"
                            argActions="[Send for Another Approval,Close the task]"
                            argTaskDescription="Approver requested changes"
                            argTaskName="Approver Requested Changes"
                            PROCESS="com.adobe.cq.projects.impl.workflow.ProjectTaskWorkflowProcess"
                            PROCESS_AUTO_ADVANCE="false"
                            PROCESS_PERSIST_ANONYMOUS_WORKITEM="true"
                            script="var initiator = workItem.getWorkflow().getInitiator();&#xd;&#xa;task.setCurrentAssignee(initiator);"
                            sendEmailNotification="true"
                            workflowStage="Photo Approval"/>
                    </taskworkflowstep>
                    <or
                        jcr:created="{Date}2018-10-12T11:24:13.070-04:00"
                        jcr:createdBy="admin"
                        jcr:lastModified="{Date}2018-10-16T15:40:09.940-04:00"
                        jcr:lastModifiedBy="admin"
                        jcr:primaryType="nt:unstructured"
                        jcr:title="Photo Grapher Actions"
                        sling:resourceType="cq/workflow/components/model/or"
                        branches="2"
                        orSplit="true"
                        script1="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Send for Another Approval&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}">
                        <_x0031_
                            jcr:primaryType="nt:unstructured"
                            sling:resourceType="cq/flow/components/parsys">
                            <goto
                                jcr:created="{Date}2018-10-12T11:14:26.811-04:00"
                                jcr:createdBy="admin"
                                jcr:description="Goto Step"
                                jcr:lastModified="{Date}2018-10-16T15:40:31.924-04:00"
                                jcr:lastModifiedBy="admin"
                                jcr:primaryType="nt:unstructured"
                                jcr:title="Goto Step"
                                sling:resourceType="cq/workflow/components/model/goto">
                                <metaData
                                    jcr:primaryType="nt:unstructured"
                                    PROCESS="com.adobe.granite.workflow.core.process.GotoProcess"
                                    PROCESS_AUTO_ADVANCE="false"
                                    script="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Send for Another Approval&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}"
                                    TARGET_NODE_PATH="/conf/global/settings/workflow/models/photo-shoot-review-approval/jcr:content/flow/taskworkflowstep"
                                    workflowStage="Photo Approval"/>
                            </goto>
                        </_x0031_>
                        <_x0032_
                            jcr:primaryType="nt:unstructured"
                            sling:resourceType="cq/flow/components/parsys">
                            <noopprocess
                                jcr:created="{Date}2018-10-12T11:24:58.599-04:00"
                                jcr:createdBy="admin"
                                jcr:description="A no operation process"
                                jcr:lastModified="{Date}2018-10-12T11:24:58.599-04:00"
                                jcr:lastModifiedBy="admin"
                                jcr:primaryType="nt:unstructured"
                                jcr:title="No Operation"
                                sling:resourceType="cq/workflow/components/workflow/noopprocess">
                                <metaData
                                    jcr:primaryType="nt:unstructured"
                                    PROCESS="/libs/workflow/scripts/noop.ecma"
                                    PROCESS_AUTO_ADVANCE="true"/>
                            </noopprocess>
                        </_x0032_>
                    </or>
                </_x0032_>
                <_x0033_
                    jcr:primaryType="nt:unstructured"
                    sling:resourceType="cq/flow/components/parsys">
                    <taskworkflowstep_cop
                        jcr:created="{Date}2018-10-11T18:22:27.331-04:00"
                        jcr:createdBy="admin"
                        jcr:description="The task assigned to Retouchers team"
                        jcr:lastModified="{Date}2018-10-16T15:00:21.082-04:00"
                        jcr:lastModifiedBy="admin"
                        jcr:primaryType="nt:unstructured"
                        jcr:title="Clip and Crop"
                        sling:resourceType="cq/projects/taskworkflowstep">
                        <metaData
                            jcr:primaryType="nt:unstructured"
                            argTaskDescription="Please incorporate the changes requested by Approver."
                            argTaskName="Clip and Crop"
                            argTaskPriority="Medium"
                            PROCESS="com.adobe.cq.projects.impl.workflow.ProjectTaskWorkflowProcess"
                            PROCESS_AUTO_ADVANCE="false"
                            PROCESS_PERSIST_ANONYMOUS_WORKITEM="true"
                            script="var projectRetoucherGrp = workflowData.getMetaDataMap().get(&quot;project.group.retoucher&quot;,&quot;administrators&quot;);&#xd;&#xa;task.setCurrentAssignee(projectRetoucherGrp);&#xd;&#xa;"
                            sendEmailNotification="true"
                            workflowStage="Retouch Approval"/>
                    </taskworkflowstep_cop>
                    <taskworkflowstep_cop_705378029
                        jcr:created="{Date}2018-10-11T18:22:27.331-04:00"
                        jcr:createdBy="admin"
                        jcr:description="The task assigned to Approvers to Review Photos"
                        jcr:lastModified="{Date}2018-10-23T16:10:15.319-04:00"
                        jcr:lastModifiedBy="pmm"
                        jcr:primaryType="nt:unstructured"
                        jcr:title="Review Clip and Cropped"
                        sling:resourceType="cq/projects/taskworkflowstep">
                        <metaData
                            jcr:primaryType="nt:unstructured"
                            argActions="[Request for Changes,Approve and Move to Final]"
                            argTaskDescription="Please review the clip and cropped photographs and provide approval or request for changes."
                            argTaskName="Review Clip and Cropped"
                            argTaskPriority="Medium"
                            PROCESS="com.adobe.cq.projects.impl.workflow.ProjectTaskWorkflowProcess"
                            PROCESS_AUTO_ADVANCE="false"
                            PROCESS_PERSIST_ANONYMOUS_WORKITEM="true"
                            script="var projectApprovalGrp = workflowData.getMetaDataMap().get(&quot;project.group.approver&quot;,&quot;administrators&quot;);&#xd;&#xa;task.setCurrentAssignee(projectApprovalGrp);&#xd;&#xa;task.setProperty(&quot;taskTypeName&quot;,&quot;dam:review&quot;);"
                            sendEmailNotification="true"
                            workflowStage="Retouch Approval"/>
                    </taskworkflowstep_cop_705378029>
                    <or
                        jcr:created="{Date}2018-10-11T18:47:28.863-04:00"
                        jcr:createdBy="admin"
                        jcr:lastModified="{Date}2018-10-23T16:05:08.097-04:00"
                        jcr:lastModifiedBy="admin"
                        jcr:primaryType="nt:unstructured"
                        jcr:title="Approver Actions on Clip and Cropp Task"
                        sling:resourceType="cq/workflow/components/model/or"
                        branches="2"
                        orSplit="true"
                        script1="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Request for Changes&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}"
                        script2="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Approve and Move to Final&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}">
                        <_x0031_
                            jcr:primaryType="nt:unstructured"
                            sling:resourceType="cq/flow/components/parsys">
                            <goto
                                jcr:created="{Date}2018-10-11T18:51:34.309-04:00"
                                jcr:createdBy="admin"
                                jcr:description="Goto Step"
                                jcr:lastModified="{Date}2018-10-23T16:20:15.341-04:00"
                                jcr:lastModifiedBy="retoucher"
                                jcr:primaryType="nt:unstructured"
                                jcr:title="Goto Step"
                                sling:resourceType="cq/workflow/components/model/goto">
                                <metaData
                                    jcr:primaryType="nt:unstructured"
                                    PROCESS="com.adobe.granite.workflow.core.process.GotoProcess"
                                    PROCESS_AUTO_ADVANCE="false"
                                    script="function check(){&#xd;&#xa;var lastAction = workflowData.getMetaDataMap().get(&quot;lastTaskAction&quot;,&quot;&quot;);&#xd;&#xa; if(lastAction == &quot;Request for Changes&quot;) {&#xd;&#xa;  return true;&#xd;&#xa;}&#xd;&#xa;return false;&#xd;&#xa;}"
                                    TARGET_NODE_PATH="/conf/global/settings/workflow/models/photo-shoot-review-approval/jcr:content/flow/or/3/taskworkflowstep_cop"
                                    workflowStage="Retouch Approval"/>
                            </goto>
                        </_x0031_>
                        <_x0032_
                            jcr:primaryType="nt:unstructured"
                            sling:resourceType="cq/flow/components/parsys">
                            <process_copy
                                jcr:created="{Date}2018-10-11T18:50:32.378-04:00"
                                jcr:createdBy="admin"
                                jcr:lastModified="{Date}2018-10-12T14:53:36.890-04:00"
                                jcr:lastModifiedBy="admin"
                                jcr:primaryType="nt:unstructured"
                                jcr:title="Auto Move Assets"
                                sling:resourceType="cq/workflow/components/model/process">
                                <metaData
                                    jcr:primaryType="nt:unstructured"
                                    PROCESS="com.adobe.summit23.l717.AEMaaCS Transition.AutoMoveApprovedPhotoAssets"
                                    PROCESS_AUTO_ADVANCE="true"
                                    workflowStage="Approvals Complete"/>
                            </process_copy>
                        </_x0032_>
                    </or>
                </_x0033_>
                <_x0034_
                    jcr:primaryType="nt:unstructured"
                    sling:resourceType="cq/flow/components/parsys">
                    <noopprocess
                        jcr:created="{Date}2018-10-16T15:07:30.507-04:00"
                        jcr:createdBy="admin"
                        jcr:description="A no operation process"
                        jcr:lastModified="{Date}2018-10-16T15:07:30.507-04:00"
                        jcr:lastModifiedBy="admin"
                        jcr:primaryType="nt:unstructured"
                        jcr:title="No Operation"
                        sling:resourceType="cq/workflow/components/workflow/noopprocess">
                        <metaData
                            jcr:primaryType="nt:unstructured"
                            PROCESS="/libs/workflow/scripts/noop.ecma"
                            PROCESS_AUTO_ADVANCE="true"/>
                    </noopprocess>
                </_x0034_>
            </or>
        </flow>
    </jcr:content>
</jcr:root>
